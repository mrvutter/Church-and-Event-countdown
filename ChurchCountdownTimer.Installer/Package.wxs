<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  
  <!-- Product Information -->
  <Product Id="*" 
           Name="Church Countdown Timer" 
           Language="1033" 
           Version="1.1.0.0" 
           Manufacturer="Church Timer App" 
           UpgradeCode="12345678-1234-1234-1234-123456789012">
    
    <!-- Package Information -->
    <Package InstallerVersion="200" 
             Compressed="yes" 
             InstallScope="perMachine"
             Description="Professional countdown timer for speakers, preachers, and event organizers"
             Comments="Church Countdown Timer v1.1.0" 
             Manufacturer="Church Timer App" />

    <!-- Media and Cabinet -->
    <Media Id="1" Cabinet="media1.cab" EmbedCab="yes" />

    <!-- Major Upgrade Logic -->
    <MajorUpgrade DowngradeErrorMessage="A newer version of Church Countdown Timer is already installed." />

    <!-- License Agreement -->
    <WixVariable Id="WixUILicenseRtf" Value="License.rtf" />

    <!-- UI Configuration -->
    <UIRef Id="WixUI_InstallDir" />
    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />

    <!-- Application Icon -->
    <Property Id="ARPPRODUCTICON" Value="app.ico" />
    <Icon Id="app.ico" SourceFile="app.ico" />

    <!-- Installation Directory Structure -->
    <StandardDirectory Id="ProgramFiles64Folder">
      <Directory Id="INSTALLFOLDER" Name="Church Countdown Timer">
        <!-- Main application files will be added here -->
      </Directory>
    </StandardDirectory>

    <!-- Start Menu Shortcut -->
    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="Church Countdown Timer" />
    </StandardDirectory>

    <!-- Desktop Shortcut -->
    <StandardDirectory Id="DesktopFolder" />

    <!-- Component Groups -->
    <ComponentGroup Id="ApplicationFiles">
      <Component Id="MainExecutable" Directory="INSTALLFOLDER">
        <File Id="ChurchCountdownTimerExe" 
              Source="$(var.ChurchCountdownTimer.TargetPath)" 
              KeyPath="yes">
          <!-- Desktop Shortcut -->
          <Shortcut Id="DesktopShortcut"
                    Directory="DesktopFolder"
                    Name="Church Countdown Timer"
                    Description="Professional countdown timer for speakers and events"
                    WorkingDirectory="INSTALLFOLDER"
                    Icon="app.ico" />
          
          <!-- Start Menu Shortcut -->
          <Shortcut Id="StartMenuShortcut"
                    Directory="ApplicationProgramsFolder"
                    Name="Church Countdown Timer"
                    Description="Professional countdown timer for speakers and events"
                    WorkingDirectory="INSTALLFOLDER"
                    Icon="app.ico" />
        </File>
      </Component>

      <!-- Remove Start Menu folder on uninstall -->
      <Component Id="ApplicationShortcutComponent" Directory="ApplicationProgramsFolder">
        <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall" />
        <RegistryValue Root="HKCU" 
                       Key="Software\Church Timer App\Church Countdown Timer" 
                       Name="installed" 
                       Type="integer" 
                       Value="1" 
                       KeyPath="yes" />
      </Component>
    </ComponentGroup>

    <!-- Features -->
    <Feature Id="MainApplication" Title="Church Countdown Timer" Level="1">
      <ComponentGroupRef Id="ApplicationFiles" />
    </Feature>

  </Product>
</Wix>
